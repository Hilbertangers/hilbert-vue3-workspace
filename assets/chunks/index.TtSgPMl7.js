import{d as $t,p as bt,v as Gt,Y as Jt,q as jt,c as Yt,o as Kt,j as Qt,P as wt}from"./framework.BJG7AQGO.js";function Zt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pt={exports:{}},Xt=Pt.exports={};Xt.forEach=function(t,s){for(var a=0;a<t.length;a++){var r=s(t[a]);if(r)return r}};var Lt=Pt.exports,Vt=function(t){var s=t.stateHandler.getState;function a(n){var o=s(n);return o&&!!o.isDetectable}function r(n){s(n).isDetectable=!0}function c(n){return!!s(n).busy}function m(n,o){s(n).busy=!!o}return{isDetectable:a,markAsDetectable:r,isBusy:c,markBusy:m}},Tt=function(t){var s={};function a(n){var o=t.get(n);return o===void 0?[]:s[o]||[]}function r(n,o){var S=t.get(n);s[S]||(s[S]=[]),s[S].push(o)}function c(n,o){for(var S=a(n),g=0,A=S.length;g<A;++g)if(S[g]===o){S.splice(g,1);break}}function m(n){var o=a(n);o&&(o.length=0)}return{get:a,add:r,removeListener:c,removeAllListeners:m}},Ct=function(){var t=1;function s(){return t++}return{generate:s}},te=function(t){var s=t.idGenerator,a=t.stateHandler.getState;function r(m){var n=a(m);return n&&n.id!==void 0?n.id:null}function c(m){var n=a(m);if(!n)throw new Error("setId required the element to have a resize detection state.");var o=s.generate();return n.id=o,o}return{get:r,set:c}},ee=function(t){function s(){}var a={log:s,warn:s,error:s};if(!t&&window.console){var r=function(c,m){c[m]=function(){var o=console[m];if(o.apply)o.apply(console,arguments);else for(var S=0;S<arguments.length;S++)o(arguments[S])}};r(a,"log"),r(a,"warn"),r(a,"error")}return a},Nt={exports:{}},Bt=Nt.exports={};Bt.isIE=function(t){function s(){var r=navigator.userAgent.toLowerCase();return r.indexOf("msie")!==-1||r.indexOf("trident")!==-1||r.indexOf(" edge/")!==-1}if(!s())return!1;if(!t)return!0;var a=function(){var r,c=3,m=document.createElement("div"),n=m.getElementsByTagName("i");do m.innerHTML="<!--[if gt IE "+ ++c+"]><i></i><![endif]-->";while(n[0]);return c>4?c:r}();return t===a};Bt.isLegacyOpera=function(){return!!window.opera};var Wt=Nt.exports,Rt={exports:{}},re=Rt.exports={};re.getOption=ne;function ne(t,s,a){var r=t[s];return r==null&&a!==void 0?a:r}var ie=Rt.exports,kt=ie,ae=function(s){s=s||{};var a=s.reporter,r=kt.getOption(s,"async",!0),c=kt.getOption(s,"auto",!0);c&&!r&&(a&&a.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),r=!0);var m=Dt(),n,o=!1;function S(k,W){!o&&c&&r&&m.size()===0&&L(),m.add(k,W)}function g(){for(o=!0;m.size();){var k=m;m=Dt(),k.process()}o=!1}function A(k){o||(k===void 0&&(k=r),n&&(q(n),n=null),k?L():g())}function L(){n=z(g)}function q(k){var W=clearTimeout;return W(k)}function z(k){var W=function(U){return setTimeout(U,0)};return W(k)}return{add:S,force:A}};function Dt(){var t={},s=0,a=0,r=0;function c(o,S){S||(S=o,o=0),o>a?a=o:o<r&&(r=o),t[o]||(t[o]=[]),t[o].push(S),s++}function m(){for(var o=r;o<=a;o++)for(var S=t[o],g=0;g<S.length;g++){var A=S[g];A()}}function n(){return s}return{add:c,process:m,size:n}}var mt="_erd";function oe(t){return t[mt]={},_t(t)}function _t(t){return t[mt]}function se(t){delete t[mt]}var de={initState:oe,getState:_t,cleanState:se},ut=Wt,ce=function(t){t=t||{};var s=t.reporter,a=t.batchProcessor,r=t.stateHandler.getState;if(!s)throw new Error("Missing required dependency: reporter.");function c(g,A){function L(){A(g)}if(ut.isIE(8))r(g).object={proxy:L},g.attachEvent("onresize",L);else{var q=o(g);if(!q)throw new Error("Element is not detectable by this strategy.");q.contentDocument.defaultView.addEventListener("resize",L)}}function m(g){var A=t.important?" !important; ":"; ";return(g.join(A)+A).trim()}function n(g,A,L){L||(L=A,A=g,g=null),g=g||{},g.debug;function q(z,k){var W=m(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),U=!1,G=window.getComputedStyle(z),D=z.offsetWidth,I=z.offsetHeight;r(z).startSize={width:D,height:I};function h(){function e(){if(G.position==="static"){z.style.setProperty("position","relative",g.important?"important":"");var b=function(v,f,y,l){function p(w){return w.replace(/[^-\d\.]/g,"")}var E=y[l];E!=="auto"&&p(E)!=="0"&&(v.warn("An element that is positioned static has style."+l+"="+E+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+l+" will be set to 0. Element: ",f),f.style.setProperty(l,"0",g.important?"important":""))};b(s,z,G,"top"),b(s,z,G,"right"),b(s,z,G,"bottom"),b(s,z,G,"left")}}function d(){U||e();function b(f,y){if(!f.contentDocument){var l=r(f);l.checkForObjectDocumentTimeoutId&&window.clearTimeout(l.checkForObjectDocumentTimeoutId),l.checkForObjectDocumentTimeoutId=setTimeout(function(){l.checkForObjectDocumentTimeoutId=0,b(f,y)},100);return}y(f.contentDocument)}var v=this;b(v,function(y){k(z)})}G.position!==""&&(e(),U=!0);var i=document.createElement("object");i.style.cssText=W,i.tabIndex=-1,i.type="text/html",i.setAttribute("aria-hidden","true"),i.onload=d,ut.isIE()||(i.data="about:blank"),r(z)&&(z.appendChild(i),r(z).object=i,ut.isIE()&&(i.data="about:blank"))}a?a.add(h):h()}ut.isIE(8)?L(A):q(A,L)}function o(g){return r(g).object}function S(g){if(r(g)){var A=o(g);A&&(ut.isIE(8)?g.detachEvent("onresize",A.proxy):g.removeChild(A),r(g).checkForObjectDocumentTimeoutId&&window.clearTimeout(r(g).checkForObjectDocumentTimeoutId),delete r(g).object)}}return{makeDetectable:n,addListener:c,uninstall:S}},fe=Lt.forEach,ue=function(t){t=t||{};var s=t.reporter,a=t.batchProcessor,r=t.stateHandler.getState;t.stateHandler.hasState;var c=t.idHandler;if(!a)throw new Error("Missing required dependency: batchProcessor");if(!s)throw new Error("Missing required dependency: reporter.");var m=A(),n="erd_scroll_detection_scrollbar_style",o="erd_scroll_detection_container";function S(h){L(h,n,o)}S(window.document);function g(h){var e=t.important?" !important; ":"; ";return(h.join(e)+e).trim()}function A(){var h=500,e=500,d=document.createElement("div");d.style.cssText=g(["position: absolute","width: "+h*2+"px","height: "+e*2+"px","visibility: hidden","margin: 0","padding: 0"]);var i=document.createElement("div");i.style.cssText=g(["position: absolute","width: "+h+"px","height: "+e+"px","overflow: scroll","visibility: none","top: "+-h*3+"px","left: "+-e*3+"px","visibility: hidden","margin: 0","padding: 0"]),i.appendChild(d),document.body.insertBefore(i,document.body.firstChild);var b=h-i.clientWidth,v=e-i.clientHeight;return document.body.removeChild(i),{width:b,height:v}}function L(h,e,d){function i(y,l){l=l||function(E){h.head.appendChild(E)};var p=h.createElement("style");return p.innerHTML=y,p.id=e,l(p),p}if(!h.getElementById(e)){var b=d+"_animation",v=d+"_animation_active",f=`/* Created by the element-resize-detector library. */
`;f+="."+d+" > div::-webkit-scrollbar { "+g(["display: none"])+` }

`,f+="."+v+" { "+g(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+b,"animation-name: "+b])+` }
`,f+="@-webkit-keyframes "+b+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,f+="@keyframes "+b+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",i(f)}}function q(h){h.className+=" "+o+"_animation_active"}function z(h,e,d){if(h.addEventListener)h.addEventListener(e,d);else if(h.attachEvent)h.attachEvent("on"+e,d);else return s.error("[scroll] Don't know how to add event listeners.")}function k(h,e,d){if(h.removeEventListener)h.removeEventListener(e,d);else if(h.detachEvent)h.detachEvent("on"+e,d);else return s.error("[scroll] Don't know how to remove event listeners.")}function W(h){return r(h).container.childNodes[0].childNodes[0].childNodes[0]}function U(h){return r(h).container.childNodes[0].childNodes[0].childNodes[1]}function G(h,e){var d=r(h).listeners;if(!d.push)throw new Error("Cannot add listener to an element that is not detectable.");r(h).listeners.push(e)}function D(h,e,d){d||(d=e,e=h,h=null),h=h||{};function i(){if(h.debug){var u=Array.prototype.slice.call(arguments);if(u.unshift(c.get(e),"Scroll: "),s.log.apply)s.log.apply(null,u);else for(var x=0;x<u.length;x++)s.log(u[x])}}function b(u){function x(P){var Y=P.getRootNode&&P.getRootNode().contains(P);return P===P.ownerDocument.body||P.ownerDocument.body.contains(P)||Y}return!x(u)||window.getComputedStyle(u)===null}function v(u){var x=r(u).container.childNodes[0],P=window.getComputedStyle(x);return!P.width||P.width.indexOf("px")===-1}function f(){var u=window.getComputedStyle(e),x={};return x.position=u.position,x.width=e.offsetWidth,x.height=e.offsetHeight,x.top=u.top,x.right=u.right,x.bottom=u.bottom,x.left=u.left,x.widthCSS=u.width,x.heightCSS=u.height,x}function y(){var u=f();r(e).startSize={width:u.width,height:u.height},i("Element start size",r(e).startSize)}function l(){r(e).listeners=[]}function p(){if(i("storeStyle invoked."),!r(e)){i("Aborting because element has been uninstalled");return}var u=f();r(e).style=u}function E(u,x,P){r(u).lastWidth=x,r(u).lastHeight=P}function w(u){return W(u).childNodes[0]}function M(){return 2*m.width+1}function H(){return 2*m.height+1}function O(u){return u+10+M()}function F(u){return u+10+H()}function N(u){return u*2+M()}function R(u){return u*2+H()}function X(u,x,P){var Y=W(u),rt=U(u),ot=O(x),st=F(P),$=N(x),j=R(P);Y.scrollLeft=ot,Y.scrollTop=st,rt.scrollLeft=$,rt.scrollTop=j}function _(){var u=r(e).container;if(!u){u=document.createElement("div"),u.className=o,u.style.cssText=g(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),r(e).container=u,q(u),e.appendChild(u);var x=function(){r(e).onRendered&&r(e).onRendered()};z(u,"animationstart",x),r(e).onAnimationStart=x}return u}function V(){function u(){var B=r(e).style;if(B.position==="static"){e.style.setProperty("position","relative",h.important?"important":"");var Z=function(ct,it,Ft,yt){function qt(Ut){return Ut.replace(/[^-\d\.]/g,"")}var vt=Ft[yt];vt!=="auto"&&qt(vt)!=="0"&&(ct.warn("An element that is positioned static has style."+yt+"="+vt+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+yt+" will be set to 0. Element: ",it),it.style[yt]=0)};Z(s,e,B,"top"),Z(s,e,B,"right"),Z(s,e,B,"bottom"),Z(s,e,B,"left")}}function x(B,Z,ct,it){return B=B?B+"px":"0",Z=Z?Z+"px":"0",ct=ct?ct+"px":"0",it=it?it+"px":"0",["left: "+B,"top: "+Z,"right: "+it,"bottom: "+ct]}if(i("Injecting elements"),!r(e)){i("Aborting because element has been uninstalled");return}u();var P=r(e).container;P||(P=_());var Y=m.width,rt=m.height,ot=g(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),st=g(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(x(-(1+Y),-(1+rt),-rt,-Y))),$=g(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),j=g(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),J=g(["position: absolute","left: 0","top: 0"]),nt=g(["position: absolute","width: 200%","height: 200%"]),K=document.createElement("div"),Q=document.createElement("div"),dt=document.createElement("div"),Et=document.createElement("div"),pt=document.createElement("div"),At=document.createElement("div");K.dir="ltr",K.style.cssText=ot,K.className=o,Q.className=o,Q.style.cssText=st,dt.style.cssText=$,Et.style.cssText=J,pt.style.cssText=j,At.style.cssText=nt,dt.appendChild(Et),pt.appendChild(At),Q.appendChild(dt),Q.appendChild(pt),K.appendChild(Q),P.appendChild(K);function xt(){var B=r(e);B&&B.onExpand?B.onExpand():i("Aborting expand scroll handler: element has been uninstalled")}function Ot(){var B=r(e);B&&B.onShrink?B.onShrink():i("Aborting shrink scroll handler: element has been uninstalled")}z(dt,"scroll",xt),z(pt,"scroll",Ot),r(e).onExpandScroll=xt,r(e).onShrinkScroll=Ot}function T(){function u($,j,J){var nt=w($),K=O(j),Q=F(J);nt.style.setProperty("width",K+"px",h.important?"important":""),nt.style.setProperty("height",Q+"px",h.important?"important":"")}function x($){var j=e.offsetWidth,J=e.offsetHeight,nt=j!==r(e).lastWidth||J!==r(e).lastHeight;i("Storing current size",j,J),E(e,j,J),a.add(0,function(){if(nt){if(!r(e)){i("Aborting because element has been uninstalled");return}if(!P()){i("Aborting because element container has not been initialized");return}if(h.debug){var Q=e.offsetWidth,dt=e.offsetHeight;(Q!==j||dt!==J)&&s.warn(c.get(e),"Scroll: Size changed before updating detector elements.")}u(e,j,J)}}),a.add(1,function(){if(!r(e)){i("Aborting because element has been uninstalled");return}if(!P()){i("Aborting because element container has not been initialized");return}X(e,j,J)}),nt&&$&&a.add(2,function(){if(!r(e)){i("Aborting because element has been uninstalled");return}if(!P()){i("Aborting because element container has not been initialized");return}$()})}function P(){return!!r(e).container}function Y(){function $(){return r(e).lastNotifiedWidth===void 0}i("notifyListenersIfNeeded invoked");var j=r(e);if($()&&j.lastWidth===j.startSize.width&&j.lastHeight===j.startSize.height)return i("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(j.lastWidth===j.lastNotifiedWidth&&j.lastHeight===j.lastNotifiedHeight)return i("Not notifying: Size already notified");i("Current size not notified, notifying..."),j.lastNotifiedWidth=j.lastWidth,j.lastNotifiedHeight=j.lastHeight,fe(r(e).listeners,function(J){J(e)})}function rt(){if(i("startanimation triggered."),v(e)){i("Ignoring since element is still unrendered...");return}i("Element rendered.");var $=W(e),j=U(e);($.scrollLeft===0||$.scrollTop===0||j.scrollLeft===0||j.scrollTop===0)&&(i("Scrollbars out of sync. Updating detector elements..."),x(Y))}function ot(){if(i("Scroll detected."),v(e)){i("Scroll event fired while unrendered. Ignoring...");return}x(Y)}if(i("registerListenersAndPositionElements invoked."),!r(e)){i("Aborting because element has been uninstalled");return}r(e).onRendered=rt,r(e).onExpand=ot,r(e).onShrink=ot;var st=r(e).style;u(e,st.width,st.height)}function at(){if(i("finalizeDomMutation invoked."),!r(e)){i("Aborting because element has been uninstalled");return}var u=r(e).style;E(e,u.width,u.height),X(e,u.width,u.height)}function ht(){d(e)}function gt(){i("Installing..."),l(),y(),a.add(0,p),a.add(1,V),a.add(2,T),a.add(3,at),a.add(4,ht)}i("Making detectable..."),b(e)?(i("Element is detached"),_(),i("Waiting until element is attached..."),r(e).onRendered=function(){i("Element is now attached"),gt()}):gt()}function I(h){var e=r(h);e&&(e.onExpandScroll&&k(W(h),"scroll",e.onExpandScroll),e.onShrinkScroll&&k(U(h),"scroll",e.onShrinkScroll),e.onAnimationStart&&k(e.container,"animationstart",e.onAnimationStart),e.container&&h.removeChild(e.container))}return{makeDetectable:D,addListener:G,uninstall:I,initDocument:S}},lt=Lt.forEach,le=Vt,he=Tt,ge=Ct,pe=te,ye=ee,Mt=Wt,be=ae,C=de,ve=ce,we=ue;function zt(t){return Array.isArray(t)||t.length!==void 0}function Ht(t){if(Array.isArray(t))return t;var s=[];return lt(t,function(a){s.push(a)}),s}function It(t){return t&&t.nodeType===1}var Se=function(t){t=t||{};var s;if(t.idHandler)s={get:function(D){return t.idHandler.get(D,!0)},set:t.idHandler.set};else{var a=ge(),r=pe({idGenerator:a,stateHandler:C});s=r}var c=t.reporter;if(!c){var m=c===!1;c=ye(m)}var n=tt(t,"batchProcessor",be({reporter:c})),o={};o.callOnAdd=!!tt(t,"callOnAdd",!0),o.debug=!!tt(t,"debug",!1);var S=he(s),g=le({stateHandler:C}),A,L=tt(t,"strategy","object"),q=tt(t,"important",!1),z={reporter:c,batchProcessor:n,stateHandler:C,idHandler:s,important:q};if(L==="scroll"&&(Mt.isLegacyOpera()?(c.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),L="object"):Mt.isIE(9)&&(c.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),L="object")),L==="scroll")A=we(z);else if(L==="object")A=ve(z);else throw new Error("Invalid strategy name: "+L);var k={};function W(D,I,h){function e(y){var l=S.get(y);lt(l,function(E){E(y)})}function d(y,l,p){S.add(l,p),y&&p(l)}if(h||(h=I,I=D,D={}),!I)throw new Error("At least one element required.");if(!h)throw new Error("Listener required.");if(It(I))I=[I];else if(zt(I))I=Ht(I);else return c.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var i=0,b=tt(D,"callOnAdd",o.callOnAdd),v=tt(D,"onReady",function(){}),f=tt(D,"debug",o.debug);lt(I,function(l){C.getState(l)||(C.initState(l),s.set(l));var p=s.get(l);if(f&&c.log("Attaching listener to element",p,l),!g.isDetectable(l)){if(f&&c.log(p,"Not detectable."),g.isBusy(l)){f&&c.log(p,"System busy making it detectable"),d(b,l,h),k[p]=k[p]||[],k[p].push(function(){i++,i===I.length&&v()});return}return f&&c.log(p,"Making detectable..."),g.markBusy(l,!0),A.makeDetectable({debug:f,important:q},l,function(w){if(f&&c.log(p,"onElementDetectable"),C.getState(w)){g.markAsDetectable(w),g.markBusy(w,!1),A.addListener(w,e),d(b,w,h);var M=C.getState(w);if(M&&M.startSize){var H=w.offsetWidth,O=w.offsetHeight;(M.startSize.width!==H||M.startSize.height!==O)&&e(w)}k[p]&&lt(k[p],function(F){F()})}else f&&c.log(p,"Element uninstalled before being detectable.");delete k[p],i++,i===I.length&&v()})}f&&c.log(p,"Already detecable, adding listener."),d(b,l,h),i++}),i===I.length&&v()}function U(D){if(!D)return c.error("At least one element is required.");if(It(D))D=[D];else if(zt(D))D=Ht(D);else return c.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");lt(D,function(I){S.removeAllListeners(I),A.uninstall(I),C.cleanState(I)})}function G(D){A.initDocument&&A.initDocument(D)}return{listenTo:W,removeListener:S.removeListener,removeAllListeners:S.removeAllListeners,uninstall:U,initDocument:G}};function tt(t,s,a){var r=t[s];return r==null&&a!==void 0?a:r}var me=Zt(Se);function Ee(t){return Object.getOwnPropertySymbols(t).filter(s=>Object.prototype.propertyIsEnumerable.call(t,s))}function Ae(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const xe="[object RegExp]",Oe="[object String]",je="[object Number]",ke="[object Boolean]",De="[object Arguments]",Me="[object Symbol]",ze="[object Date]",He="[object Map]",Ie="[object Set]",Pe="[object Array]",Le="[object ArrayBuffer]",Ne="[object Object]",Be="[object DataView]",We="[object Uint8Array]",Re="[object Uint8ClampedArray]",_e="[object Uint16Array]",Fe="[object Uint32Array]",qe="[object Int8Array]",Ue="[object Int16Array]",$e="[object Int32Array]",Ge="[object Float32Array]",Je="[object Float64Array]";function Ye(t){return t==null||typeof t!="object"&&typeof t!="function"}function Ke(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ft(t,s,a,r=new Map,c=void 0){const m=c==null?void 0:c(t,s,a,r);if(m!==void 0)return m;if(Ye(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const n=new Array(t.length);r.set(t,n);for(let o=0;o<t.length;o++)n[o]=ft(t[o],o,a,r,c);return Object.hasOwn(t,"index")&&(n.index=t.index),Object.hasOwn(t,"input")&&(n.input=t.input),n}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const n=new RegExp(t.source,t.flags);return n.lastIndex=t.lastIndex,n}if(t instanceof Map){const n=new Map;r.set(t,n);for(const[o,S]of t)n.set(o,ft(S,o,a,r,c));return n}if(t instanceof Set){const n=new Set;r.set(t,n);for(const o of t)n.add(ft(o,void 0,a,r,c));return n}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(Ke(t)){const n=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,n);for(let o=0;o<t.length;o++)n[o]=ft(t[o],o,a,r,c);return n}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const n=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,n),et(n,t,a,r,c),n}if(typeof File<"u"&&t instanceof File){const n=new File([t],t.name,{type:t.type});return r.set(t,n),et(n,t,a,r,c),n}if(typeof Blob<"u"&&t instanceof Blob){const n=new Blob([t],{type:t.type});return r.set(t,n),et(n,t,a,r,c),n}if(t instanceof Error){const n=new t.constructor;return r.set(t,n),n.message=t.message,n.name=t.name,n.stack=t.stack,n.cause=t.cause,et(n,t,a,r,c),n}if(t instanceof Boolean){const n=new Boolean(t.valueOf());return r.set(t,n),et(n,t,a,r,c),n}if(t instanceof Number){const n=new Number(t.valueOf());return r.set(t,n),et(n,t,a,r,c),n}if(t instanceof String){const n=new String(t.valueOf());return r.set(t,n),et(n,t,a,r,c),n}if(typeof t=="object"&&Qe(t)){const n=Object.create(Object.getPrototypeOf(t));return r.set(t,n),et(n,t,a,r,c),n}return t}function et(t,s,a=t,r,c){const m=[...Object.keys(s),...Ee(s)];for(let n=0;n<m.length;n++){const o=m[n],S=Object.getOwnPropertyDescriptor(t,o);(S==null||S.writable)&&(t[o]=ft(s[o],o,a,r,c))}}function Qe(t){switch(Ae(t)){case De:case Pe:case Le:case Be:case ke:case ze:case Ge:case Je:case qe:case Ue:case $e:case He:case je:case Ne:case xe:case Ie:case Oe:case Me:case We:case Re:case _e:case Fe:return!0;default:return!1}}function St(t){return ft(t,void 0,t,new Map,void 0)}var Xe=$t({__name:"Flow",props:{value:{type:String,required:!0,default:""},orWidthRate:{type:Number,required:!1,default:.9},orHeightRate:{type:Number,required:!1,default:.5},orHybridRate:{type:Number,required:!1,default:.5},nodeStyle:{type:Object,required:!1,default:()=>({height:30,fontSize:12,padding:15,branchPaddingMin:20,marginMin:10,color:{success:{fill:"#19be6b",font:"#fff"},fail:{fill:"#ed4014",font:"#fff"},default:{fill:"#ddd",font:"#666"}}})},nodeMap:{type:Array,required:!1,default:()=>[]}},emits:["fetch-struct"],setup(t,{emit:s}){const a=t,r=s,c=bt(),m=bt(),n=bt(null),o=bt([]);let S;function g(){const e=a.value.replace(/\s+/g,"");o.value=D(e),r("fetch-struct",o.value),n.value=null,A()}function A(){if(!c.value)return;const e=c.value.getContext("2d"),d=L(),i=q();if(e.clearRect(0,0,d,i),W(e),!o.value.length)return;z(e,o.value,d,i,0,0,[1])==="restart"&&wt(A)}function L(){const e=n.value||m.value.offsetWidth;return c.value.width=e,e}function q(){const e=a.nodeStyle.height+a.nodeStyle.branchPaddingMin,d=[e],i=(v,f)=>{for(const y of v)if(Array.isArray(y.value)){let l=e*(y.value.length-1);const p=St(f),E=p.reduce((w,M)=>w*M,l);d.push(E),p.push(y.value.length),y.value.forEach(w=>i(w,p))}};i(o.value,[2]);const b=Math.max(...d);return c.value.height=b,b}function z(e,d,i,b,v,f,y){let l=d.every(p=>p.type==="or")&&"justOr"||d.every(p=>p.type==="node")&&"justNode"||"orAndNode";if(l==="justOr"){let p=i*a.orWidthRate/d.length,E=b*a.orHeightRate,w=(b-E)/2+f;y.push(a.orWidthRate/d.length);for(let M=0;M<d.length;M++){let H=d[M],O=(i-p*d.length)/2+p*M+v;U(e,O,w,p,E,H.value.length);for(let F=0;F<H.value.length;F++){let N=H.value[F],R=E*2/H.value.length,X=E/(H.value.length-1);for(let _=0;_<N.length;_++)z(e,N,p,R,O,w-R/2+F*X,y)==="restart"&&wt(A)}}}if(l==="justNode"){let p=(i-d.reduce((w,M)=>w+M.width,0))/(d.length+1);p=Math.round(p);let E=f+b/2;if(p<a.nodeStyle.marginMin){let w=(a.nodeStyle.marginMin-p)*(d.length+1);return h(y,w+i),"restart"}for(let w=0;w<d.length;w++){let M=d[w],H=d.reduce((O,F,N)=>N<w?O+F.width:O,v+p*(w+1));k(e,M,H,E)}}if(l==="orAndNode"){let p=d.filter(N=>N.type==="node"),E=d.filter(N=>N.type==="or"),w=p.reduce((N,R)=>N+R.width,0),M=i*a.orHybridRate,H=M/E.length,O=(i-(w+M))/(p.length+E.length+1);if(O<a.nodeStyle.marginMin){let N=(a.nodeStyle.marginMin-O+50)*(d.length+1);return h(y,N+i),"restart"}let F=St(y);F.push(H/i);for(let N=0;N<d.length;N++){let R=d[N],X=d.reduce((_,V,T)=>{let at=V.type==="node"?V.width:H;return T<N?_+at:_},v+O*(N+1));if(R.type==="node"){let _=f+b/2;k(e,R,X,_)}if(R.type==="or"){let _=b*a.orHeightRate,V=(b-_)/2+f;U(e,X,V,H,_,R.value.length);for(let T=0;T<R.value.length;T++){let at=R.value[T],ht=_*2/R.value.length,gt=_/(R.value.length-1);for(let u=0;u<at.length;u++)z(e,at,H,ht,X,V-ht/2+T*gt,F)==="restart"&&wt(A)}}}}}function k(e,d,i,b){let{height:v,color:f}=a.nodeStyle,{width:y,content:l,status:p}=d,E=i,w=b-v/2,M=null,H=null;switch(p){case!0:M=f.success.fill,H=f.success.font;break;case!1:M=f.fail.fill,H=f.fail.font;break;default:M=f.default.fill,H=f.default.font}e.beginPath(),e.rect(E,w,y,v),e.strokeStyle="rgba(186, 165, 130, 0.8)",e.lineWidth=2;let O=v/2;y-v<0&&(O=y/2),e.beginPath(),e.arc(E+O,w+O,O,Math.PI,Math.PI*3/2),e.lineTo(y-O+E,w),e.arc(y-O+E,O+w,O,Math.PI*3/2,Math.PI*2),e.lineTo(y+E,v+w-O),e.arc(y-O+E,v-O+w,O,0,Math.PI*1/2),e.lineTo(O+E,v+w),e.arc(O+E,v-O+w,O,Math.PI*1/2,Math.PI),e.closePath(),e.stroke(),e.fillStyle=M,e.fill(),e.textAlign="center",e.fillStyle=H,e.font=`${a.nodeStyle.fontSize}px sans-serif`,e.fillText(l,E+y/2,w+19)}function W(e){const d=c.value.width,i=c.value.height;e.beginPath(),e.lineWidth=2,e.strokeStyle="#009966",e.moveTo(0,i/2),e.lineTo(d,i/2),e.stroke()}function U(e,d,i,b,v,f=2,y=0){let l=d+y,p=i,E=b-y*2,w=v;e.beginPath(),e.lineWidth=2,e.strokeStyle="#009966",e.rect(l,p,E,w),e.fillStyle="#fff",e.fill(),f>2&&[...Array(f-2)].forEach((M,H)=>{e.moveTo(l,p+w/(f-1)*(H+1)),e.lineTo(l+E,p+w/(f-1)*(H+1))}),e.stroke()}function G(){const e=/^(.*?)&/;function d(b){let v=[],f=null,y=b.indexOf("|");for(;y!==-1&&(f=b.substring(0,y),f.split("").forEach(l=>{l==="("&&v.push("("),l===")"&&v.pop()}),v.length);)f=null,v=[],y=b.indexOf("|",y+1);return f}function i(b){let v=["("],f=null;if(b.indexOf("(")===0){let y=b.split("");for(let l=1;l<y.length;l++)if(y[l]==="("&&v.push("("),y[l]===")"&&v.pop(),!v.length){f=b.substring(1,l);break}}return f}return{and:e,findOrMatch:d,findBracketsMatch:i}}function D(e){const d=G();let i=[],b,v=!1;for(;e;){b=e;const f=d.findOrMatch(e);if(f){v=!0,i[0]||i.push({type:"or",value:[]}),Array.isArray(i[0].value)&&i[0].value.push(D(f)),e=e.slice(f.length+1);continue}if(v){Array.isArray(i[0].value)&&i[0].value.push(D(b)),v=!1;break}const y=d.findBracketsMatch(e);if(y){i.push(...D(y)),e=e.slice(y.length+2);continue}const l=e.match(d.and);if(l){l[1]&&i.push(I(l[1])),e=e.slice(l[1].length+1);continue}if(b===e){i.push(I(b));break}}return i}function I(e){const{padding:d,fontSize:i}=a.nodeStyle,v=c.value.getContext("2d");v.font=`${i}px sans-serif`;const f=a.nodeMap.find(w=>w.value===e),y=(f==null?void 0:f.label)??"",l=(f==null?void 0:f.status)??void 0,p=y?`${e}:${y}`:e,E=v.measureText(p).width+d*2;return{type:"node",value:e,content:p,width:E,status:l}}function h(e,d){const i=St(e).reverse();n.value=i.reduce((b,v)=>b/v,d)}return Gt(()=>{S=me(),g(),S.listenTo(m.value,A)}),Jt(()=>{S==null||S.uninstall(m.value)}),jt(()=>a.value,g),jt(()=>a.nodeMap,g,{deep:!0}),(e,d)=>(Kt(),Yt("div",{ref_key:"wrapper",ref:m,class:"flow",style:{background:"#fff",width:"100%"}},[Qt("canvas",{ref_key:"canvas",ref:c},null,512)],512))}});export{Xe as s};
